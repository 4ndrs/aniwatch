import{r as l,j as w}from"./iframe-DOy6vm9F.js";import{c as de,d as he}from"./index-PY8cXWUg.js";import"./preload-helper-D9Z9MdNV.js";import"./iconBase-kV2UoGIi.js";const X=me();function d(e,...t){if(!X)return;const r=pe(e,...t);performance.mark(r);try{console.log(e,...t)}catch{console.log(r)}}function fe(e,...t){X&&console.warn(e,...t)}function pe(e,...t){return e.replace(/%[sfdO]/g,r=>{const s=t.shift();return r==="%O"&&s?JSON.stringify(s).replace(/"([^"]+)":/g,"$1:"):String(s)})}function me(){try{const e="nuqs-localStorage-test";if(typeof localStorage>"u")return!1;localStorage.setItem(e,e);const t=localStorage.getItem(e)===e;return localStorage.removeItem(e),t&&(localStorage.getItem("debug")||"").includes("nuqs")}catch{return!1}}const ge={303:"Multiple adapter contexts detected. This might happen in monorepos.",404:"nuqs requires an adapter to work with your framework.",409:"Multiple versions of the library are loaded. This may lead to unexpected behavior. Currently using `%s`, but `%s` (via the %s adapter) was about to load on top.",414:"Max safe URL length exceeded. Some browsers may not be able to accept this URL. Consider limiting the amount of state stored in the URL.",429:"URL update rate-limited by the browser. Consider increasing `throttleMs` for key(s) `%s`. %O",500:"Empty search params cache. Search params can't be accessed in Layouts.",501:"Search params cache already populated. Have you called `parse` twice?"};function z(e){return`[nuqs] ${ge[e]}
  See https://err.47ng.com/NUQS-${e}`}function be(e){if(e.size===0)return"";const t=[];for(const[s,n]of e.entries()){const o=s.replace(/#/g,"%23").replace(/&/g,"%26").replace(/\+/g,"%2B").replace(/=/g,"%3D").replace(/\?/g,"%3F");t.push(`${o}=${qe(n)}`)}return"?"+t.join("&")}function qe(e){return e.replace(/%/g,"%25").replace(/\+/g,"%2B").replace(/ /g,"+").replace(/#/g,"%23").replace(/&/g,"%26").replace(/"/g,"%22").replace(/'/g,"%27").replace(/`/g,"%60").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/[\x00-\x1F]/g,t=>encodeURIComponent(t))}const E=l.createContext({useAdapter(){throw new Error(z(404))}});E.displayName="NuqsAdapterContext";X&&typeof window<"u"&&(window.__NuqsAdapterContext&&window.__NuqsAdapterContext!==E&&console.error(z(303)),window.__NuqsAdapterContext=E);function ve(e){return({children:t,defaultOptions:r,...s})=>l.createElement(E.Provider,{...s,value:{useAdapter:e,defaultOptions:r}},t)}function Se(e){const t=l.useContext(E);if(!("useAdapter"in t))throw new Error(z(404));return t.useAdapter(e)}const ye=()=>l.useContext(E).defaultOptions;function we(){if(typeof window>"u"||!!!window.GestureEvent)return 50;try{const t=navigator.userAgent?.match(/version\/([\d\.]+) safari/i);return parseFloat(t[1])>=17?120:320}catch{return 320}}function Oe(e){return{method:"throttle",timeMs:e}}function xe(e){return{method:"debounce",timeMs:e}}const M=Oe(we());function Y(){const e=new Map;return{all:e,on(t,r){const s=e.get(t)||[];return s.push(r),e.set(t,s),()=>this.off(t,r)},off(t,r){const s=e.get(t);s&&e.set(t,s.filter(n=>n!==r))},emit(t,r){e.get(t)?.forEach(n=>n(r))}}}function K(e,t,r){function s(){e(),r.removeEventListener("abort",o)}const n=setTimeout(s,t);function o(){clearTimeout(n),r.removeEventListener("abort",o)}r.addEventListener("abort",o)}function G(){const e=Promise;if(Promise.hasOwnProperty("withResolvers"))return Promise.withResolvers();let t=()=>{},r=()=>{};return{promise:new e((n,o)=>{t=n,r=o}),resolve:t,reject:r}}function je(e,t){let r=t;for(let s=e.length-1;s>=0;s--){const n=e[s];if(!n)continue;const o=r;r=()=>n(o)}r()}function oe(){return new URLSearchParams(location.search)}var ue=class{updateMap=new Map;options={history:"replace",scroll:!1,shallow:!0};timeMs=M.timeMs;transitions=new Set;resolvers=null;controller=new AbortController;lastFlushedAt=0;push({key:e,query:t,options:r},s=M.timeMs){d("[nuqs gtq] Enqueueing %s=%s %O",e,t,r),this.updateMap.set(e,t),r.history==="push"&&(this.options.history="push"),r.scroll&&(this.options.scroll=!0),r.shallow===!1&&(this.options.shallow=!1),r.startTransition&&this.transitions.add(r.startTransition),(!Number.isFinite(this.timeMs)||s>this.timeMs)&&(this.timeMs=s)}getQueuedQuery(e){return this.updateMap.get(e)}flush({getSearchParamsSnapshot:e=oe,rateLimitFactor:t=1,...r}){if(!Number.isFinite(this.timeMs))return d("[nuqs gtq] Skipping flush due to throttleMs=Infinity"),Promise.resolve(e());if(this.resolvers)return this.resolvers.promise;this.resolvers=G();const s=()=>{this.lastFlushedAt=performance.now();const[o,u]=this.applyPendingUpdates({...r,autoResetQueueOnUpdate:r.autoResetQueueOnUpdate??!0,getSearchParamsSnapshot:e});u===null?this.resolvers.resolve(o):this.resolvers.reject(o),this.resolvers=null};return K(()=>{const u=performance.now()-this.lastFlushedAt,c=this.timeMs,a=t*Math.max(0,c-u);d("[nuqs gtq] Scheduling flush in %f ms. Throttled at %f ms (x%f)",a,c,t),a===0?s():K(s,a,this.controller.signal)},0,this.controller.signal),this.resolvers.promise}abort(){return this.controller.abort(),this.controller=new AbortController,this.resolvers?.resolve(new URLSearchParams),this.resolvers=null,this.reset()}reset(){const e=Array.from(this.updateMap.keys());return d("[nuqs gtq] Resetting queue %s",JSON.stringify(Object.fromEntries(this.updateMap))),this.updateMap.clear(),this.transitions.clear(),this.options={history:"replace",scroll:!1,shallow:!0},this.timeMs=M.timeMs,e}applyPendingUpdates(e){const{updateUrl:t,getSearchParamsSnapshot:r}=e,s=r();if(d("[nuqs gtq] Applying %d pending update(s) on top of %s",this.updateMap.size,s.toString()),this.updateMap.size===0)return[s,null];const n=Array.from(this.updateMap.entries()),o={...this.options},u=Array.from(this.transitions);e.autoResetQueueOnUpdate&&this.reset(),d("[nuqs gtq] Flushing queue %O with options %O",n,o);for(const[c,a]of n)a===null?s.delete(c):s.set(c,a);try{return je(u,()=>{t(s,o)}),[s,null]}catch(c){return console.error(z(429),n.map(([a])=>a).join(),c),[s,c]}}};const H=new ue;function Ue(e,t,r){const s=l.useCallback(()=>{const u=Object.fromEntries(e.map(a=>[a,r(a)]));return[JSON.stringify(u),u]},[e.join(","),r]),n=l.useRef(null);n.current===null&&(n.current=s());const o=l.useCallback(u=>{const c=e.map(a=>t(a,u));return()=>c.forEach(a=>a())},[e.join(","),t]);return l.useSyncExternalStore(o,()=>{const[u,c]=s();return n.current[0]===u?n.current[1]:(n.current=[u,c],c)},()=>n.current[1])}var Ce=class{callback;resolvers=G();controller=new AbortController;queuedValue=void 0;constructor(e){this.callback=e}abort(){this.controller.abort(),this.queuedValue=void 0}push(e,t){return this.queuedValue=e,this.controller.abort(),this.controller=new AbortController,K(()=>{const r=this.resolvers;try{d("[nuqs dq] Flushing debounce queue",e);const s=this.callback(e);d("[nuqs dq] Reset debounce queue %O",this.queuedValue),this.queuedValue=void 0,this.resolvers=G(),s.then(n=>r.resolve(n)).catch(n=>r.reject(n))}catch(s){this.queuedValue=void 0,r.reject(s)}},t,this.controller.signal),this.resolvers.promise}},Re=class{throttleQueue;queues=new Map;queuedQuerySync=Y();constructor(e=new ue){this.throttleQueue=e}useQueuedQueries(e){return Ue(e,(t,r)=>this.queuedQuerySync.on(t,r),t=>this.getQueuedQuery(t))}push(e,t,r){if(!Number.isFinite(t)){const o=r.getSearchParamsSnapshot??oe;return Promise.resolve(o())}const s=e.key;if(!this.queues.has(s)){d("[nuqs dqc] Creating debounce queue for `%s`",s);const o=new Ce(u=>(this.throttleQueue.push(u),this.throttleQueue.flush(r).finally(()=>{this.queues.get(u.key)?.queuedValue===void 0&&(d("[nuqs dqc] Cleaning up empty queue for `%s`",u.key),this.queues.delete(u.key)),this.queuedQuerySync.emit(u.key)})));this.queues.set(s,o)}d("[nuqs dqc] Enqueueing debounce update %O",e);const n=this.queues.get(s).push(e,t);return this.queuedQuerySync.emit(s),n}abort(e){const t=this.queues.get(e);return t?(d("[nuqs dqc] Aborting debounce queue %s=%s",e,t.queuedValue?.query),this.queues.delete(e),t.abort(),this.queuedQuerySync.emit(e),r=>(r.then(t.resolvers.resolve,t.resolvers.reject),r)):r=>r}abortAll(){for(const[e,t]of this.queues.entries())d("[nuqs dqc] Aborting debounce queue %s=%s",e,t.queuedValue?.query),t.abort(),t.resolvers.resolve(new URLSearchParams),this.queuedQuerySync.emit(e);this.queues.clear()}getQueuedQuery(e){const t=this.queues.get(e)?.queuedValue?.query;return t!==void 0?t:this.throttleQueue.getQueuedQuery(e)}};const $=new Re(H);function ae(e,t,r){try{return e(t)}catch(s){return fe("[nuqs] Error while parsing value `%s`: %O"+(r?" (for key `%s`)":""),t,s,r),null}}function O(e){function t(r){if(typeof r>"u")return null;let s="";if(Array.isArray(r)){if(r[0]===void 0)return null;s=r[0]}return typeof r=="string"&&(s=r),ae(e.parse,s)}return{eq:(r,s)=>r===s,...e,parseServerSide:t,withDefault(r){return{...this,defaultValue:r,parseServerSide(s){return t(s)??r}}},withOptions(r){return{...this,...r}}}}const Me=O({parse:e=>e,serialize:String});O({parse:e=>{const t=parseInt(e);return t==t?t:null},serialize:e=>""+Math.round(e)});O({parse:e=>{const t=parseInt(e);return t==t?t-1:null},serialize:e=>""+Math.round(e+1)});O({parse:e=>{const t=parseInt(e,16);return t==t?t:null},serialize:e=>{const t=Math.round(e).toString(16);return(t.length&1?"0":"")+t}});O({parse:e=>{const t=parseFloat(e);return t==t?t:null},serialize:String});O({parse:e=>e==="true",serialize:String});function Z(e,t){return e.valueOf()===t.valueOf()}O({parse:e=>{const t=parseInt(e);return t==t?new Date(t):null},serialize:e=>""+e.valueOf(),eq:Z});O({parse:e=>{const t=new Date(e);return t.valueOf()==t.valueOf()?t:null},serialize:e=>e.toISOString(),eq:Z});O({parse:e=>{const t=new Date(e.slice(0,10));return t.valueOf()==t.valueOf()?t:null},serialize:e=>e.toISOString().slice(0,10),eq:Z});const B=Y(),Pe={};function Ae(e,t={}){const r=l.useId(),s=ye(),{history:n="replace",scroll:o=s?.scroll??!1,shallow:u=s?.shallow??!0,throttleMs:c=M.timeMs,limitUrlUpdates:a=s?.limitUrlUpdates,clearOnDefault:b=s?.clearOnDefault??!0,startTransition:g,urlKeys:y=Pe}=t,f=Object.keys(e).join(","),p=l.useMemo(()=>Object.fromEntries(Object.keys(e).map(i=>[i,y[i]??i])),[f,JSON.stringify(y)]),x=Se(Object.values(p)),j=x.searchParams,C=l.useRef({}),L=l.useMemo(()=>Object.fromEntries(Object.keys(e).map(i=>[i,e[i].defaultValue??null])),[Object.values(e).map(({defaultValue:i})=>i).join(",")]),P=$.useQueuedQueries(Object.values(p)),[T,V]=l.useState(()=>{const i=j??new URLSearchParams;return J(e,y,i,P).state}),S=l.useRef(T);if(d("[nuq+ %s `%s`] render - state: %O, iSP: %s",r,f,T,j),Object.keys(C.current).join("&")!==Object.values(p).join("&")){const{state:i,hasChanged:m}=J(e,y,j,P,C.current,S.current);m&&(d("[nuq+ %s `%s`] State changed: %O",r,f,{state:i,initialSearchParams:j,queuedQueries:P,queryRef:C.current,stateRef:S.current}),S.current=i,V(i)),C.current=Object.fromEntries(Object.values(p).map(h=>[h,j?.get(h)??null]))}l.useEffect(()=>{const{state:i,hasChanged:m}=J(e,y,j,P,C.current,S.current);m&&(d("[nuq+ %s `%s`] State changed: %O",r,f,{state:i,initialSearchParams:j,queuedQueries:P,queryRef:C.current,stateRef:S.current}),S.current=i,V(i))},[Object.values(p).map(i=>`${i}=${j?.get(i)}`).join("&"),JSON.stringify(P)]),l.useEffect(()=>{function i(h){d("[nuq+ %s `%s`] updateInternalState %O",r,f,h),S.current=h,V(h)}const m=Object.keys(e).reduce((h,v)=>(h[v]=({state:N,query:D})=>{const{defaultValue:Q}=e[v],F=p[v];S.current={...S.current,[v]:N??Q??null},C.current[F]=D,d("[nuq+ %s `%s`] Cross-hook key sync %s: %O (default: %O). Resolved: %O",r,f,F,N,Q,S.current),i(S.current)},h),{});for(const h of Object.keys(e)){const v=p[h];d("[nuq+ %s `%s`] Subscribing to sync for `%s`",r,v,f),B.on(v,m[h])}return()=>{for(const h of Object.keys(e)){const v=p[h];d("[nuq+ %s `%s`] Unsubscribing to sync for `%s`",r,v,f),B.off(v,m[h])}}},[f,p]);const ce=l.useCallback((i,m={})=>{const h=Object.fromEntries(Object.keys(e).map(A=>[A,null])),v=typeof i=="function"?i(se(S.current,L))??h:i??h;d("[nuq+ %s `%s`] setState: %O",r,f,v);let N,D=0;const Q=[];for(let[A,U]of Object.entries(v)){const q=e[A],_=p[A];if(!q)continue;(m.clearOnDefault??q.clearOnDefault??b)&&U!==null&&q.defaultValue!==void 0&&(q.eq??((R,k)=>R===k))(U,q.defaultValue)&&(U=null);const te=U===null?null:(q.serialize??String)(U);B.emit(_,{state:U,query:te});const re={key:_,query:te,options:{history:m.history??q.history??n,shallow:m.shallow??q.shallow??u,scroll:m.scroll??q.scroll??o,startTransition:m.startTransition??q.startTransition??g}};if(m?.limitUrlUpdates?.method==="debounce"||a?.method==="debounce"||q.limitUrlUpdates?.method==="debounce"){const R=m?.limitUrlUpdates?.timeMs??a?.timeMs??q.limitUrlUpdates?.timeMs??M.timeMs,k=$.push(re,R,x);D<R&&(N=k,D=R)}else{const R=m?.limitUrlUpdates?.timeMs??q?.limitUrlUpdates?.timeMs??a?.timeMs??m.throttleMs??q.throttleMs??c;Q.push($.abort(_)),H.push(re,R)}}const F=Q.reduce((A,U)=>U(A),H.flush(x));return N??F},[f,n,u,o,c,a?.method,a?.timeMs,g,p,x.updateUrl,x.getSearchParamsSnapshot,x.rateLimitFactor,L]);return[l.useMemo(()=>se(T,L),[T,L]),ce]}function J(e,t,r,s,n,o){let u=!1;const c=Object.keys(e).reduce((a,b)=>{const g=t?.[b]??b,{parse:y}=e[b],f=s[g],p=f===void 0?r?.get(g)??null:f;if(n&&o&&(n[g]??null)===p)return a[b]=o[b]??null,a;u=!0;const x=p===null?null:ae(y,p,b);return a[b]=x??null,n&&(n[g]=p),a},{});if(!u){const a=Object.keys(e),b=Object.keys(o??{});u=a.length!==b.length||a.some(g=>!b.includes(g))}return{state:c,hasChanged:u}}function se(e,t){return Object.fromEntries(Object.keys(e).map(r=>[r,e[r]??t[r]??null]))}function Ee(e,t={}){const{parse:r=g=>g,serialize:s,eq:n,defaultValue:o,...u}=t,[{[e]:c},a]=Ae({[e]:{parse:r,serialize:s,eq:n,defaultValue:o}},u),b=l.useCallback((g,y={})=>a(f=>({[e]:typeof g=="function"?g(f[e]):g}),y),[e,a]);return[c,b]}const ee=({id:e})=>{const[t,r]=Ee("search",Me.withDefault("").withOptions({history:"push",shallow:!1,limitUrlUpdates:xe(500)})),s=l.useRef(null);return w.jsxs("div",{onClick:({target:n})=>{n?.closest("button")||s.current?.focus()},className:"text-text bg-foreground-sp flex items-center gap-3 rounded-md px-4 py-[0.6875rem] font-(family-name:--font-overpass) text-[0.8125rem] leading-[0.934375rem] hover:cursor-text",children:[w.jsx(de,{"aria-hidden":!0,className:"text-gray-x400 pointer-events-none h-4 w-[0.8125rem] shrink-0"}),w.jsx("input",{id:e,ref:s,value:t,inputMode:"search",spellCheck:!1,autoCorrect:"off",autoComplete:"off",autoCapitalize:"off",onChange:({target:{value:n}})=>r(n,n===""?{limitUrlUpdates:M}:void 0),className:"ring-blue flex-1 border-none outline-none"}),w.jsx("button",{disabled:!t,"aria-label":"Clear Search",onClick:()=>{s.current?.focus(),r("",{limitUrlUpdates:M})},className:"text-gray-x400 hover:text-gray-x500 ring-blue focus-visible:text-gray-x500 shrink-0 cursor-pointer rounded-sm ring-offset-2 ring-offset-transparent transition-colors duration-200 outline-none focus-visible:ring-1 disabled:pointer-events-none disabled:opacity-0",children:w.jsx(he,{className:"h-4 w-[0.6875rem]"})})]})};ee.__docgenInfo={description:"",methods:[],displayName:"SearchBar",props:{id:{required:!1,tsType:{name:"string"},description:""}}};function ne(e,t,r){return s=>{if(!(t.length===0?!0:t.some(u=>s.get(u)!==e.get(u))))return d("[nuqs `%s`] no change, returning previous",t.join(","),s),s;const o=ie(e,t,r);return d("[nuqs `%s`] subbed search params change\n  from %O\n  to   %O",t.join(","),s,o),o}}function ie(e,t,r){if(t.length===0)return e;const s=r?new URLSearchParams(e):e;for(const n of e.keys())t.includes(n)||s.delete(n);return s}const Ne="__nuqs__",W=Y();function Qe(e){return function(r,s){const n=new URL(location.href);n.search=be(r),d("[nuqs react] Updating url: %s",n),e&&s.shallow===!1?(s.history==="push"?location.assign:location.replace).call(location,n):(s.history==="push"?history.pushState:history.replaceState).call(history,history.state,Ne,n),W.emit("update",r),s.scroll===!0&&window.scrollTo({top:0})}}const le=l.createContext({fullPageNavigationOnShallowFalseUpdates:!1});function Le(e){const{fullPageNavigationOnShallowFalseUpdates:t}=l.useContext(le),[r,s]=l.useState(()=>typeof location>"u"?new URLSearchParams:ie(new URLSearchParams(location.search),e,!1));l.useEffect(()=>{const o=()=>{s(ne(new URLSearchParams(location.search),e,!1))},u=c=>{s(ne(c,e,!0))};return W.on("update",u),window.addEventListener("popstate",o),()=>{W.off("update",u),window.removeEventListener("popstate",o)}},[e.join("&")]);const n=l.useMemo(()=>Qe(t),[t]);return{searchParams:r,updateUrl:n}}const Te=ve(Le);function De({children:e,fullPageNavigationOnShallowFalseUpdates:t=!1,...r}){return l.createElement(le.Provider,{value:{fullPageNavigationOnShallowFalseUpdates:t}},l.createElement(Te,{...r,children:e}))}const ke={tags:["autodocs"],component:ee},I={args:{},render:e=>w.jsx(De,{children:w.jsx("div",{className:"flex gap-2",children:w.jsx("div",{className:"w-[381px]",children:w.jsx(ee,{...e})})})})};I.parameters={...I.parameters,docs:{...I.parameters?.docs,source:{originalSource:`{
  args: {},
  render: args => <NuqsAdapter>
      <div className="flex gap-2">
        <div className="w-[381px]">
          <SearchBar {...args} />
        </div>
      </div>
    </NuqsAdapter>
}`,...I.parameters?.docs?.source}}};const $e=["Default"];export{I as Default,$e as __namedExportsOrder,ke as default};
